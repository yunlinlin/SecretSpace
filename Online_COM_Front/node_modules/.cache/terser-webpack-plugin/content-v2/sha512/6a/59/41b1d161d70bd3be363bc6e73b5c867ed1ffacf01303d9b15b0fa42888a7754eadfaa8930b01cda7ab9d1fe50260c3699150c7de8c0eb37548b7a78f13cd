{"code":"(wx[\"webpackJsonp\"]=wx[\"webpackJsonp\"]||[]).push([[9],{113:function(e,t,s){},129:function(e,t,s){\"use strict\";s.r(t);var i=s(4),a=s(6),n=s(7),c=s(15),o=s(9),r=s(10),l=s(13),m=s(1),u=s(0),d=s(8),h=s(3),j=s.n(h),p=(s(113),s(2)),f=j.a.getApp(),k=function(e){Object(o[\"a\"])(s,e);var t=Object(r[\"a\"])(s);function s(e){var i;return Object(a[\"a\"])(this,s),i=t.call(this,e),Object(l[\"a\"])(Object(c[\"a\"])(i),\"$instance\",Object(h[\"getCurrentInstance\"])()),i.state={detail:{},imageList:[],comment:[],OnComment:!1,uploadComment:\"\",liked:!1,stored:!1},i}return Object(n[\"a\"])(s,[{key:\"componentDidMount\",value:function(){var e=this,t=f.post.request((this.$instance.router?this.$instance.router.params.url:f.config.file)+\"/detail\",\"GET\",{id:JSON.parse(this.$instance.router&&this.$instance.router.params.id?this.$instance.router.params.id:\"\"),classify:this.$instance.router&&this.$instance.router.params.class?this.$instance.router.params.class:\"\"});t.then((function(t){\"/activity\"===(e.$instance.router?e.$instance.router.params.url:\"\")?e.setState({detail:t.data.detail[0],imageList:t.data.imageList,liked:t.data.liked,stored:t.data.stored}):e.setState({detail:t.data.detail[0],imageList:t.data.imageList,comment:t.data.comment,liked:t.data.liked,stored:t.data.stored}),console.log(e.state.detail)}))}},{key:\"componentWillReceiveProps\",value:function(e){console.log(this.props,e)}},{key:\"shouldComponentUpdate\",value:function(e){return this.state!==e}},{key:\"componentWillUnmount\",value:function(){}},{key:\"componentDidlUpdate\",value:function(){}},{key:\"componentDidShow\",value:function(){}},{key:\"componentDidHide\",value:function(){}},{key:\"ToComment\",value:function(){this.setState({OnComment:!0})}},{key:\"WriteComment\",value:function(e){this.setState({uploadComment:e})}},{key:\"handOnComment\",value:function(){var e=this,t=f.post.request((this.$instance.router?this.$instance.router.params.url:f.config.file)+\"/addComment\",\"POST\",{nickname:j.a.getStorageSync(\"NICKNAME\"),comment:this.state.uploadComment,id:JSON.parse(this.$instance.router&&this.$instance.router.params.id?this.$instance.router.params.id:\"\")}).catch((function(e){console.log(e),j.a.showToast({title:\"\\u4e0a\\u4f20\\u8bc4\\u8bba\\u5931\\u8d25\",icon:\"error\",duration:2e3})}));t.then((function(){j.a.showToast({title:\"\\u4e0a\\u4f20\\u8bc4\\u8bba\\u6210\\u529f\",icon:\"success\",duration:2e3}),setTimeout((function(){e.setState({OnComment:!1})}),1e3)}))}},{key:\"itemLike\",value:function(){var e=this,t=f.post.request((this.$instance.router?this.$instance.router.params.url:f.config.file)+\"/like\",\"POST\",{item_id:JSON.parse(this.$instance.router&&this.$instance.router.params.id?this.$instance.router.params.id:\"\"),classify:this.$instance.router&&this.$instance.router.params.class?this.$instance.router.params.class:\"\",option:!1===this.state.liked?\"add\":\"delete\"}).catch((function(e){console.log(e),j.a.showToast({title:\"\\u70b9\\u8d5e\\u5931\\u8d25\",icon:\"error\",duration:2e3})}));t.then((function(){e.setState({liked:!1===e.state.liked})}))}},{key:\"itemStore\",value:function(){var e=this,t=f.post.request((this.$instance.router?this.$instance.router.params.url:f.config.file)+\"/store\",\"POST\",{item_id:JSON.parse(this.$instance.router&&this.$instance.router.params.id?this.$instance.router.params.id:\"\"),classify:this.$instance.router&&this.$instance.router.params.class?this.$instance.router.params.class:\"\",option:!1===this.state.stored?\"add\":\"delete\"}).catch((function(e){console.log(e),j.a.showToast({title:\"\\u6536\\u85cf\\u5931\\u8d25\",icon:\"error\",duration:2e3})}));t.then((function(){e.setState({stored:!1===e.state.stored})}))}},{key:\"commentLike\",value:function(e,t){var s=this,i=f.post.request((this.$instance.router?this.$instance.router.params.url:f.config.file)+\"/commentLike\",\"POST\",{comment_id:t,option:!1===this.state.comment[e].liked?\"add\":\"delete\"}).catch((function(e){console.log(e),j.a.showToast({title:\"\\u70b9\\u8d5e\\u5931\\u8d25\",icon:\"error\",duration:2e3})}));i.then((function(){var t=s.state.comment;t.map((function(t,s){t.likeCount=s===e?!1===t.liked?t.likeCount+1:t.likeCount-1:t.likeCount,t.liked=s===e?!t.liked:t.liked})),s.setState({comment:t})}))}},{key:\"preview\",value:function(e){var t=new Array,s=f.config.file+this.state.imageList[e].localPath;this.state.imageList.map((function(e){t.push(f.config.file+e.localPath)})),j.a.previewImage({current:s,urls:t})}},{key:\"render\",value:function(){var e=this;return\"activity\"===(this.$instance.router?this.$instance.router.params.class:\"\")?Object(p[\"jsxs\"])(u[\"s\"],{className:\"at-article\",children:[Object(p[\"jsx\"])(u[\"s\"],{className:\"at-article__h1\",children:this.state.detail.topicValue}),Object(p[\"jsxs\"])(u[\"s\"],{className:\"at-article__info\",children:[this.state.detail.created_at,\"\\xa0\\xa0\\xa0\",this.state.detail.nickname]}),Object(p[\"jsx\"])(u[\"s\"],{className:\"at-article__content\",children:Object(p[\"jsxs\"])(u[\"s\"],{className:\"at-article__section\",children:[Object(p[\"jsx\"])(u[\"s\"],{className:\"at-article__h3\",children:\"\\u6d3b\\u52a8\\u65f6\\u95f4\\uff1a\"}),Object(p[\"jsx\"])(u[\"s\"],{className:\"at-article__p\",children:this.state.detail.year+\"-\"+this.state.detail.month+\"-\"+this.state.detail.date+\"  \"+this.state.detail.timeValue}),Object(p[\"jsx\"])(u[\"s\"],{className:\"at-article__h3\",children:\"\\u6d3b\\u52a8\\u5730\\u70b9\\uff1a\"}),Object(p[\"jsx\"])(u[\"s\"],{className:\"at-article__p\",children:this.state.detail.placeValue}),Object(p[\"jsx\"])(u[\"s\"],{className:\"at-article__h3\",children:\"\\u6d3b\\u52a8\\u5185\\u5bb9\\uff1a\"}),Object(p[\"jsx\"])(u[\"s\"],{className:\"at-article__p\",children:this.state.detail.contentValue}),this.state.imageList.map((function(t,s){return Object(p[\"jsx\"])(u[\"e\"],{className:\"at-article__img\",src:f.config.file+t.localPath,mode:\"widthFix\",onClick:e.preview.bind(e,s)},s)})),Object(p[\"jsx\"])(u[\"s\"],{className:\"option-box\",children:!0===this.state.liked?Object(p[\"jsx\"])(u[\"e\"],{className:\"option-like\",src:f.config.file+\"/item_liked.png\"}):Object(p[\"jsx\"])(u[\"e\"],{className:\"option-like\",src:f.config.file+\"/item_unlike.png\"})})]})})]}):Object(p[\"jsxs\"])(u[\"s\"],{children:[Object(p[\"jsxs\"])(u[\"s\"],{className:\"at-article\",children:[Object(p[\"jsx\"])(u[\"s\"],{className:\"at-article__h1\",children:this.state.detail.topicValue}),Object(p[\"jsxs\"])(u[\"s\"],{className:\"at-article__info\",children:[this.state.detail.created_at,\"\\xa0\\xa0\\xa0\",this.state.detail.nickname]}),Object(p[\"jsx\"])(u[\"s\"],{className:\"at-article__content\",children:Object(p[\"jsxs\"])(u[\"s\"],{className:\"at-article__section\",children:[Object(p[\"jsx\"])(u[\"s\"],{className:\"at-article__p\",children:this.state.detail.contentValue}),this.state.imageList.map((function(t,s){return Object(p[\"jsx\"])(u[\"e\"],{className:\"at-article__img\",src:f.config.file+t.localPath,mode:\"widthFix\",onClick:e.preview.bind(e,s)},s)}))]})})]}),Object(p[\"jsxs\"])(u[\"s\"],{className:\"option\",children:[Object(p[\"jsx\"])(u[\"s\"],{className:\"option-like\",children:!0===this.state.liked?Object(p[\"jsx\"])(u[\"e\"],{className:\"image-like\",src:f.config.file+\"/item_liked.png\",onClick:function(){return e.itemLike()}}):Object(p[\"jsx\"])(u[\"e\"],{className:\"image-like\",src:f.config.file+\"/item_unlike.png\",onClick:function(){return e.itemLike()}})}),Object(p[\"jsx\"])(u[\"s\"],{className:\"option-store\",children:!0===this.state.stored?Object(p[\"jsx\"])(u[\"e\"],{className:\"image-store\",src:f.config.file+\"/stored.png\",onClick:function(){return e.itemStore()}}):Object(p[\"jsx\"])(u[\"e\"],{className:\"image-store\",src:f.config.file+\"/unstore.png\",onClick:function(){return e.itemStore()}})})]}),Object(p[\"jsx\"])(u[\"q\"],{className:\"comment-title\",children:\"\\u7559\\u8a00\\u680f\"}),Object(p[\"jsx\"])(u[\"s\"],{className:\"comment\",children:this.state.comment.length>0?this.state.comment.map((function(t,s){return Object(p[\"jsxs\"])(u[\"s\"],{className:\"comment-list\",children:[Object(p[\"jsxs\"])(u[\"s\"],{className:\"comment-msg\",children:[Object(p[\"jsx\"])(u[\"e\"],{className:\"user-image\",src:f.config.file+t.avatar,mode:\"aspectFill\"}),Object(p[\"jsx\"])(u[\"q\"],{className:\"user-nickname\",children:t.nickname}),Object(p[\"jsx\"])(u[\"s\"],{className:0===t.likeCount?\"comment-nobody\":\"comment-likecount\",children:t.likeCount}),!0===t.liked?Object(p[\"jsx\"])(u[\"e\"],{className:\"liked\",src:f.config.file+\"/comment_liked.png\",onClick:e.commentLike.bind(e,s,t.id)}):Object(p[\"jsx\"])(u[\"e\"],{className:\"unliked\",src:f.config.file+\"/comment_unlike.png\",onClick:e.commentLike.bind(e,s,t.id)})]}),Object(p[\"jsx\"])(u[\"s\"],{className:\"comment-content\",children:t.content})]},s)})):Object(p[\"jsx\"])(u[\"s\"],{className:\"none\",children:\"\\u5feb\\u6765\\u62a2\\u6c99\\u53d1\\uff5e\"})}),Object(p[\"jsx\"])(d[\"f\"],{className:\"comment-fab\",size:\"normal\",onClick:function(){return e.ToComment()},children:Object(p[\"jsx\"])(u[\"q\"],{children:\"\\u6211\\u8981\\u7559\\u8a00\"})}),Object(p[\"jsxs\"])(d[\"g\"],{isOpened:this.state.OnComment,title:\"\\u7559\\u8a00\\u5185\\u5bb9\",children:[Object(p[\"jsx\"])(d[\"o\"],{value:this.state.uploadComment,onChange:function(t){return e.WriteComment(t)},count:!1,maxLength:200,placeholder:\"\\u8bc4\\u8bba\\u5185\\u5bb9...\",height:300}),Object(p[\"jsx\"])(u[\"s\"],{className:\"comment-submit\",onClick:function(){return e.handOnComment()},children:Object(p[\"jsx\"])(u[\"q\"],{children:\"\\u53d1\\u5e03\\u7559\\u8a00\"})})]})]})}}]),s}(m[\"Component\"]),O=k,b={navigationBarTitleText:\"\\u8be6\\u60c5\\u9875\"};Page(Object(i[\"createPageConfig\"])(O,\"pages/Detail/Detail\",{root:{cn:[]}},b||{}))}},[[129,0,1,2]]]);","extractedComments":[]}