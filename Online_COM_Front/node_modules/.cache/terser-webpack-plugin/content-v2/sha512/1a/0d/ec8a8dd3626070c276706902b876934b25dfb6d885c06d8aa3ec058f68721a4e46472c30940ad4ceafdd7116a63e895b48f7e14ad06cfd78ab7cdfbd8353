{"code":"(wx[\"webpackJsonp\"]=wx[\"webpackJsonp\"]||[]).push([[3],{20:function(e,t,a){\"use strict\";var s=a(6),n=a(7),c=a(9),i=a(10),r=a(1),o=a(3),l=a.n(o),h=a(0),u=(a(88),a(2)),d=l.a.getApp(),m=function(e){Object(c[\"a\"])(a,e);var t=Object(i[\"a\"])(a);function a(e){var n;return Object(s[\"a\"])(this,a),n=t.call(this,e),n.state={list:[]},n}return Object(n[\"a\"])(a,[{key:\"componentDidMount\",value:function(){this.loadList(this.props.url,this.props.class)}},{key:\"shouldComponentUpdate\",value:function(e,t){return this.props.url===e.url&&this.props.class===e.class||this.loadList(e.url,e.class),this.state.list!==t.list}},{key:\"componentWillUnmount\",value:function(){}},{key:\"componentDidShow\",value:function(){}},{key:\"componentDidHide\",value:function(){}},{key:\"loadList\",value:function(e,t){var a=this,s=d.post.request(e,\"GET\",{classify:t});s.then((function(e){if(0!==e.data.length){for(var t=305,s=new Array(e.data.length),n=0;n<e.data.length;n++)0!==e.data[n].image.length?s[n]=e.data[n].image[0].height*t/e.data[n].image[0].width:s[n]=305;for(var c=[0,0],i=[new Array,new Array],r=0;r<e.data.length;r++){var o=e.data[r].topicValue.length>10?2:1;2===o&&e.data[r].topicValue.length>15&&(e.data[r].topicValue=e.data[r].topicValue.substring(0,15)+\"...\");var l=c[1]<c[0]?1:0;i[l].push(e.data[r]),c[l]+=s[r]+29*o}a.setState({list:i})}else a.setState({list:[]})})).catch((function(e){l.a.showToast({title:e.message,icon:\"error\",duration:2e3})}))}},{key:\"imageError\",value:function(e,t){var a=this.state.list;a[e][t].image[0].url=\"/imageError.jpg\",this.setState({list:a})}},{key:\"toDetail\",value:function(e){l.a.navigateTo({url:\"/pages/Detail/Detail?class=\"+this.props.class+\"&url=/\"+this.props.url.split(\"/\")[1]+\"&id=\"+e})}},{key:\"render\",value:function(){var e=this;return 0===this.state.list.length?Object(u[\"jsx\"])(h[\"s\"],{className:\"none-list\",children:Object(u[\"jsx\"])(h[\"q\"],{children:\"\\u6682\\u65f6\\u8fd8\\u6ca1\\u6709\\u5185\\u5bb9\\u54e6\\uff5e\"})}):Object(u[\"jsx\"])(h[\"s\"],{className:\"main\",children:this.state.list.map((function(t,a){return Object(u[\"jsx\"])(h[\"s\"],{className:\"column\",children:t.map((function(t,s){return Object(u[\"jsxs\"])(h[\"s\"],{className:\"column_item\",onClick:e.toDetail.bind(e,t.id),children:[Object(u[\"jsxs\"])(h[\"s\"],{className:\"user_msg\",children:[Object(u[\"jsx\"])(h[\"e\"],{src:d.config.file+t.avatar,mode:\"aspectFill\"}),Object(u[\"jsx\"])(h[\"q\"],{children:t.nickname}),Object(u[\"jsx\"])(h[\"q\"],{className:\"time\",children:t.created_at.split(\" \")[0]})]}),Object(u[\"jsx\"])(h[\"e\"],{src:0!==t.image.length?d.config.file+t.image[0].localPath:d.config.file+\"/imageDefault.jpg\",className:\"column_pic\",mode:\"widthFix\",onError:e.imageError.bind(e,a,s)}),Object(u[\"jsx\"])(h[\"s\"],{className:\"topic\",children:t.topicValue}),Object(u[\"jsxs\"])(h[\"s\"],{className:\"column-msg\",children:[Object(u[\"jsx\"])(h[\"e\"],{className:\"like\",src:d.config.file+\"/sumItemLike.png\"}),Object(u[\"jsx\"])(h[\"q\"],{children:t.likeCount}),Object(u[\"jsx\"])(h[\"e\"],{className:\"store\",src:d.config.file+\"/sumItemStore.png\"}),Object(u[\"jsx\"])(h[\"q\"],{children:t.storeCount})]})]},s)}))},a)}))})}}]),a}(r[\"Component\"]);t[\"a\"]=m},28:function(e,t,a){\"use strict\";var s=a(6),n=a(7),c=a(9),i=a(10),r=a(1),o=a(0),l=a(8),h=(a(87),a(2)),u=new Date,d=function(e){Object(c[\"a\"])(a,e);var t=Object(i[\"a\"])(a);function a(e){var n;return Object(s[\"a\"])(this,a),n=t.call(this,e),n.state={calShow:!0,dateShow:!0,year:2001,month:u.getMonth(),selectweeks:[],date:u.getDate()},n}return Object(n[\"a\"])(a,[{key:\"componentDidMount\",value:function(){this.setState({calShow:!0}),this.getWeek(new Date)}},{key:\"componentWillReceiveProps\",value:function(e){console.log(this.props,e)}},{key:\"componentWillUnmount\",value:function(){}},{key:\"componentDidlUpdate\",value:function(){this.getWeek(new Date)}},{key:\"getWeek\",value:function(e){for(var t=this,a=new Date(e),s=a.getFullYear(),n=a.getMonth()+1,c=a.getDate(),i=[],r={firstDay:new Date(s,n-1,1).getDay(),lastMonthDays:[],currentMonthDys:[],nextMonthDays:[],endDay:new Date(s,n,0).getDay(),weeks:[]},o=r.firstDay;o>0;o--)r.lastMonthDays.push({date:new Date(s,n-1,1-o).getDate()+\"\",month:n-1});for(var l=1;l<=new Date(s,n,0).getDate();l++){var h=!1;r.currentMonthDys.push({date:l+\"\",month:n,have:h})}for(var u=1;u<7-r.endDay;u++)r.nextMonthDays.push({date:u+\"\",month:n+1});i=i.concat(r.lastMonthDays,r.currentMonthDys,r.nextMonthDays);for(var d=0;d<i.length;d++)d%7===0&&(r.weeks[d/7]=new Array(7)),r.weeks[Math.floor(d/7)][d%7]=i[d];this.setState({selectweeks:r.weeks,month:n,year:s,date:c},(function(){var e=t.judgeDate();t.props.dateUpdate(t.state.year,t.state.month,t.state.date,e)}))}},{key:\"dataBefor\",value:function(e){var t=0,a=e.currentTarget.dataset.type;t=\"0\"===e.currentTarget.dataset.id?-1:1;var s=this.state.year+\"-\"+this.state.month+\"-\"+this.state.date,n=this.getDate(s,t,\"month\"===a?\"month\":\"year\");this.getWeek(n)}},{key:\"getDate\",value:function(e,t){var a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:\"day\",s=new Date(e);switch(a){case\"month\":var n=new Date(s.getFullYear(),s.getMonth()+t+1,-0).getDate(),c=s.getDate()>n?n:s.getDate();s.setMonth(s.getMonth()+t,c);break;case\"year\":s.setFullYear(s.getFullYear()+t);break}var i=s.getFullYear(),r=s.getMonth()+1<10?\"0\"+(s.getMonth()+1):s.getMonth()+1,o=s.getDate()<10?\"0\"+s.getDate():s.getDate();return i+\"-\"+r+\"-\"+o}},{key:\"selectDay\",value:function(e){var t=e.currentTarget.dataset.index,a=e.currentTarget.dataset.week,s=this.state.year,n=e.currentTarget.dataset.ischeck,c=this.state.selectweeks;if(!n)return!1;var i=c[a][t].month<10?\"0\"+c[a][t].month:c[a][t].month,r=c[a][t].date<10?\"0\"+c[a][t].date:c[a][t].date;this.getWeek(s+\"-\"+i+\"-\"+r)}},{key:\"packup\",value:function(){var e=this;if(this.props.isOpen){var t=e.state.year+\"-\"+e.state.month+\"-\"+e.state.date,a=e.getDate(t,0);e.getWeek(a)}else e.setState({dateShow:!1},(function(){setTimeout((function(){e.setState({calShow:!1},(function(){var t=e.state.year+\"-\"+e.state.month+\"-\"+e.state.date,a=e.getDate(t,0);e.getWeek(a)}))}),300)}))}},{key:\"judgeDate\",value:function(){var e=new Date(new Date),t=e.getFullYear(),a=e.getMonth()+1,s=e.getDate(),n=0;return n=this.state.year<t||this.state.month<a||this.state.year===t&&this.state.month===a&&this.state.date<s?-1:this.state.year===t&&this.state.month===a&&this.state.date-s<14||this.state.year===t&&this.state.month===a+1&&this.state.date+(new Date(this.state.year,this.state.month,-0).getDate()-s)<13||this.state.year===t+1&&1===this.state.month&&12===a&&this.state.date+(31-s)<13?this.state.month===a?this.state.date-s:this.state.date+new Date(t,a,-0).getDate()-s+1:15,n}},{key:\"backtoday\",value:function(){this.getWeek(new Date)}},{key:\"componentDidShow\",value:function(){}},{key:\"componentDidHide\",value:function(){}},{key:\"render\",value:function(){var e=this,t=this.state,a=t.calShow,s=t.dateShow,n=t.year,c=t.date,i=t.selectweeks,r=t.month;if(a)return Object(h[\"jsx\"])(o[\"s\"],{className:[this.props.isOpen?\"\":\"calendar-box\",s?\"active\":\"\"].join(\"\"),children:Object(h[\"jsxs\"])(o[\"s\"],{className:[\"calendar-wrapper\",s?\"active\":\"\"].join(\"\"),children:[Object(h[\"jsxs\"])(o[\"s\"],{className:\"calendar-panel\",children:[Object(h[\"jsx\"])(o[\"s\"],{className:\"iconfont\",\"data-id\":\"0\",\"data-type\":\"month\",onClick:function(t){return e.dataBefor(t)},children:Object(h[\"jsx\"])(l[\"i\"],{value:\"chevron-left\",size:\"20\",color:\"#35a4de\"})}),Object(h[\"jsxs\"])(o[\"s\"],{className:\"calendar-panel-box\",children:[Object(h[\"jsxs\"])(o[\"s\"],{children:[n,\"\\u5e74\"]}),Object(h[\"jsxs\"])(o[\"s\"],{children:[r<10?\"0\"+r:r,\"\\u6708\"]})]}),Object(h[\"jsx\"])(o[\"s\"],{className:\"iconfont flex-center\",\"data-id\":\"1\",\"data-type\":\"month\",onClick:function(t){return e.dataBefor(t)},children:Object(h[\"jsx\"])(l[\"i\"],{value:\"chevron-right\",size:\"20\",color:\"#35a4de\"})})]}),Object(h[\"jsxs\"])(o[\"s\"],{className:\"calendar-header\",children:[Object(h[\"jsx\"])(o[\"q\"],{children:\"\\u65e5\"}),Object(h[\"jsx\"])(o[\"q\"],{children:\"\\u4e00\"}),Object(h[\"jsx\"])(o[\"q\"],{children:\"\\u4e8c\"}),Object(h[\"jsx\"])(o[\"q\"],{children:\"\\u4e09\"}),Object(h[\"jsx\"])(o[\"q\"],{children:\"\\u56db\"}),Object(h[\"jsx\"])(o[\"q\"],{children:\"\\u4e94\"}),Object(h[\"jsx\"])(o[\"q\"],{children:\"\\u516d\"})]}),Object(h[\"jsx\"])(o[\"s\"],{className:\"calendar-body\",children:Object(h[\"jsx\"])(o[\"a\"],{children:i.map((function(t,a){return Object(h[\"jsx\"])(o[\"s\"],{className:\"calender-body-date-week\",children:Object(h[\"jsx\"])(o[\"a\"],{children:t.map((function(t,s){return Object(h[\"jsx\"])(o[\"s\"],{className:[\"date\",t.date===c.toString()&&t.month===r?\"date-current\":\"\",t.month===r?\"\":\"placeholder\"].join(\",\"),\"data-week\":a,\"data-index\":s,\"data-ischeck\":t.month===r,onClick:function(t){return e.selectDay(t)},children:Object(h[\"jsx\"])(o[\"q\"],{className:\"datebox\",children:t.date})},s)}))})},a)}))})}),Object(h[\"jsx\"])(o[\"s\"],{className:\"packup\",onClick:function(){return e.backtoday()},children:\"\\u56de\\u5230\\u4eca\\u5929\"})]})})}}]),a}(r[\"PureComponent\"]);t[\"a\"]=d},87:function(e,t,a){},88:function(e,t,a){}}]);","extractedComments":[]}