{"code":"(wx[\"webpackJsonp\"]=wx[\"webpackJsonp\"]||[]).push([[44],{120:function(e,t,a){\"use strict\";a.r(t);var n=a(4),c=a(6),s=a(7),l=a(9),i=a(10),o=a(1),r=a(0),h=a(8),u=a(3),d=a.n(u),j=d.a.getApp(),m=[\"\\u5f81\\u53cb\",\"\\u5e2e\\u5fd9\",\"\\u95ee\\u9898\\u54a8\\u8be2\",\"\\u6d3b\\u52a8\"],O=[\"item\",\"/activity\"];function p(e,t,a){for(var n=new Array,c=0;c<t.length;c++)n.push(new Promise((function(n,s){d.a.uploadFile({url:j.config.api+e+\"/imageAdd\",filePath:t[c].url,name:\"file\",formData:{title:a,num:c+1},header:{authorrization:\"Bearer \".concat(d.a.getStorageSync(\"USER\")),\"content-type\":\"application/x-www-form-urlencoded\",uid:\"\".concat(d.a.getStorageSync(\"UID\"))},success:function(e){500===e.statusCode?s(new Error(JSON.parse(e.data))):n(e)},fail:s})})));return n}a(97);var x=a(2),f=d.a.getApp(),b=function(e){Object(l[\"a\"])(a,e);var t=Object(i[\"a\"])(a);function a(e){var n;return Object(c[\"a\"])(this,a),n=t.call(this,e),n.state={topicValue:\"\",timeValue:\"\",placeValue:\"\",contentValue:\"\",height:200,files:[],dateSelect:\"2000-01-01\",selectorChecked:-1},n}return Object(s[\"a\"])(a,[{key:\"componentWillReceiveProps\",value:function(e){console.log(this.props,e)}},{key:\"componentWillUnmount\",value:function(){}},{key:\"componentDidShow\",value:function(){}},{key:\"componentDidHide\",value:function(){}},{key:\"uploadClass\",value:function(e){this.setState({selectorChecked:parseInt(e.detail.value)})}},{key:\"handOnTopic\",value:function(e){this.setState({topicValue:e})}},{key:\"handOnTime\",value:function(e){this.setState({timeValue:e})}},{key:\"handOnPlace\",value:function(e){this.setState({placeValue:e})}},{key:\"handOnContent\",value:function(e,t){e=t.target.value,this.setState({contentValue:e})}},{key:\"handOnImage\",value:function(e){this.setState({files:e})}},{key:\"UploadActivity\",value:function(){var e=this,t=new Array,a=p(O[this.state.selectorChecked],this.state.files,this.state.topicValue);Promise.all(a).then((function(a){a.map((function(e){t.push(JSON.parse(e.data))}));var n=JSON.stringify(t),c=f.post.request(\"/activity/add\",\"POST\",{topicValue:e.state.topicValue,timeValue:e.state.timeValue,placeValue:e.state.placeValue,contentValue:e.state.contentValue,dateSelect:e.state.dateSelect,imageInfo:n});c.then((function(t){if(console.log(t.data),500===t.statusCode)throw new Error(t.data);d.a.showToast({title:t.data,icon:\"success\",duration:2e3}).then((function(){setTimeout((function(){e.Back()}),2e3)}))}))})).catch((function(e){d.a.showToast({title:e.message,icon:\"error\",duration:2e3})}))}},{key:\"handOnDate\",value:function(e){this.setState({dateSelect:e.detail.value})}},{key:\"Back\",value:function(){var e=d.a.getCurrentPages(),t=e[e.length-2];t.onLoad(),d.a.navigateBack({delta:1})}},{key:\"uploadDetail\",value:function(){new Array,p(O[this.state.selectorChecked],this.state.files,this.state.topicValue)}},{key:\"render\",value:function(){var e=this;return-1===this.state.selectorChecked?Object(x[\"jsx\"])(r[\"r\"],{className:\"container\",children:Object(x[\"jsx\"])(r[\"j\"],{mode:\"selector\",range:m,onChange:function(t){return e.uploadClass(t)},children:Object(x[\"jsx\"])(h[\"k\"],{children:Object(x[\"jsx\"])(h[\"l\"],{title:\"\\u8bf7\\u9009\\u62e9\\u9700\\u8981\\u4e0a\\u4f20\\u7684\\u7c7b\\u578b\",extraText:m[this.state.selectorChecked]})})})}):3===this.state.selectorChecked?Object(x[\"jsxs\"])(r[\"r\"],{className:\"container\",children:[Object(x[\"jsxs\"])(r[\"r\"],{className:\"title\",children:[Object(x[\"jsx\"])(r[\"r\"],{className:\"title-dot\"}),Object(x[\"jsx\"])(r[\"p\"],{className:\"act-title\",children:\"\\u6d3b\\u52a8\\u6807\\u9898\"})]}),Object(x[\"jsx\"])(h[\"o\"],{className:\"content\",value:this.state.topicValue,onChange:function(t){return e.handOnTopic(t)},count:!1,maxLength:200,placeholder:\"\\u60a8\\u7684\\u6d3b\\u52a8\\u4e3b\\u9898\\u662f...(\\u5efa\\u8bae15\\u5b57\\u4ee5\\u5185)\",height:80}),Object(x[\"jsxs\"])(r[\"r\"],{className:\"title\",children:[Object(x[\"jsx\"])(r[\"r\"],{className:\"title-dot\"}),Object(x[\"jsx\"])(r[\"p\"],{className:\"act-title\",children:\"\\u6d3b\\u52a8\\u65e5\\u671f\"})]}),Object(x[\"jsx\"])(r[\"r\"],{className:\"date-select\",children:Object(x[\"jsx\"])(r[\"j\"],{mode:\"date\",value:\"\",onChange:function(t){return e.handOnDate(t)},children:Object(x[\"jsx\"])(h[\"k\"],{children:Object(x[\"jsx\"])(h[\"l\"],{title:\"\\u8bf7\\u9009\\u62e9\\u65e5\\u671f\",extraText:this.state.dateSelect})})})}),Object(x[\"jsxs\"])(r[\"r\"],{className:\"title\",children:[Object(x[\"jsx\"])(r[\"r\"],{className:\"title-dot\"}),Object(x[\"jsx\"])(r[\"p\"],{className:\"act-title\",children:\"\\u6d3b\\u52a8\\u65f6\\u95f4\\u6bb5\"})]}),Object(x[\"jsx\"])(h[\"o\"],{className:\"content\",value:this.state.timeValue,onChange:function(t){return e.handOnTime(t)},count:!1,maxLength:50,placeholder:\"9:00~18:00\",height:40}),Object(x[\"jsxs\"])(r[\"r\"],{className:\"title\",children:[Object(x[\"jsx\"])(r[\"r\"],{className:\"title-dot\"}),Object(x[\"jsx\"])(r[\"p\"],{className:\"act-title\",children:\"\\u6d3b\\u52a8\\u5730\\u70b9\"})]}),Object(x[\"jsx\"])(h[\"o\"],{className:\"content\",value:this.state.placeValue,onChange:function(t){return e.handOnPlace(t)},count:!1,maxLength:100,placeholder:\"\\u60a8\\u7684\\u6d3b\\u52a8\\u5730\\u70b9\\u662f...\",height:40}),Object(x[\"jsxs\"])(r[\"r\"],{className:\"title\",children:[Object(x[\"jsx\"])(r[\"r\"],{className:\"title-dot\"}),Object(x[\"jsx\"])(r[\"p\"],{className:\"act-title\",children:\"\\u6d3b\\u52a8\\u5185\\u5bb9\\u7b80\\u4ecb\"})]}),Object(x[\"jsx\"])(h[\"o\"],{className:\"content\",value:this.state.contentValue,onChange:function(t,a){return e.handOnContent(t,a)},maxLength:500,placeholder:\"\\u60a8\\u7684\\u6d3b\\u52a8\\u5185\\u5bb9\\u662f...\",height:this.state.height+200}),Object(x[\"jsxs\"])(r[\"r\"],{className:\"title\",children:[Object(x[\"jsx\"])(r[\"r\"],{className:\"title-dot\"}),Object(x[\"jsx\"])(r[\"p\"],{className:\"act-title\",children:\"\\u56fe\\u7247\\u4fe1\\u606f\\uff08\\u7b2c\\u4e00\\u5f20\\u4f5c\\u4e3a\\u5c55\\u677f\\uff09\"})]}),Object(x[\"jsx\"])(h[\"j\"],{files:this.state.files,onChange:function(t){return e.handOnImage(t)}}),Object(x[\"jsx\"])(r[\"r\"],{className:\"submit\",onClick:function(){return e.UploadActivity()},children:Object(x[\"jsx\"])(r[\"p\"],{children:\"\\u63d0\\u4ea4\"})})]}):Object(x[\"jsxs\"])(r[\"r\"],{className:\"container\",children:[Object(x[\"jsxs\"])(r[\"r\"],{className:\"title\",children:[Object(x[\"jsx\"])(r[\"r\"],{className:\"title-dot\"}),Object(x[\"jsx\"])(r[\"p\"],{className:\"act-title\",children:\"\\u5185\\u5bb9\\u6807\\u9898\"})]}),Object(x[\"jsx\"])(h[\"o\"],{className:\"content\",value:this.state.topicValue,onChange:function(t){return e.handOnTopic(t)},count:!1,maxLength:200,placeholder:\"\\u60a8\\u7684\\u6d3b\\u52a8\\u4e3b\\u9898\\u662f...(\\u5efa\\u8bae15\\u5b57\\u4ee5\\u5185)\",height:80}),Object(x[\"jsxs\"])(r[\"r\"],{className:\"title\",children:[Object(x[\"jsx\"])(r[\"r\"],{className:\"title-dot\"}),Object(x[\"jsx\"])(r[\"p\"],{className:\"act-title\",children:\"\\u5185\\u5bb9\\u8bf4\\u660e\"})]}),Object(x[\"jsx\"])(h[\"o\"],{className:\"content\",value:this.state.contentValue,onChange:function(t,a){return e.handOnContent(t,a)},maxLength:500,placeholder:\"\\u60a8\\u7684\\u5177\\u4f53\\u5185\\u5bb9\\u662f...\",height:this.state.height+200}),Object(x[\"jsxs\"])(r[\"r\"],{className:\"title\",children:[Object(x[\"jsx\"])(r[\"r\"],{className:\"title-dot\"}),Object(x[\"jsx\"])(r[\"p\"],{className:\"act-title\",children:\"\\u56fe\\u7247\\u4fe1\\u606f\\uff08\\u7b2c\\u4e00\\u5f20\\u4f5c\\u4e3a\\u5c55\\u677f\\uff09\"})]}),Object(x[\"jsx\"])(h[\"j\"],{files:this.state.files,onChange:function(t){return e.handOnImage(t)}}),Object(x[\"jsx\"])(r[\"r\"],{className:\"submit\",onClick:function(){return e.uploadDetail()},children:Object(x[\"jsx\"])(r[\"p\"],{children:\"\\u63d0\\u4ea4\"})})]})}}]),a}(o[\"Component\"]),g=b,N={navigationBarTitleText:\"\\u6211\\u8981\\u4e0a\\u4f20\"};Page(Object(n[\"createPageConfig\"])(g,\"pages/upload/upload\",{root:{cn:[]}},N||{}))},97:function(e,t,a){}},[[120,0,1,2]]]);","extractedComments":[]}