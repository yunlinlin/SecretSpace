{"code":"(wx[\"webpackJsonp\"]=wx[\"webpackJsonp\"]||[]).push([[8],{112:function(e,t,i){},128:function(e,t,i){\"use strict\";i.r(t);var a=i(4),s=i(6),n=i(7),c=i(15),l=i(9),o=i(10),r=i(13),d=i(1),m=i(0),u=i(8),h=i(3),j=i.n(h),p=(i(112),i(2)),f=j.a.getApp(),O=function(e){Object(l[\"a\"])(i,e);var t=Object(o[\"a\"])(i);function i(e){var a;return Object(s[\"a\"])(this,i),a=t.call(this,e),Object(r[\"a\"])(Object(c[\"a\"])(a),\"$instance\",Object(h[\"getCurrentInstance\"])()),a.state={detail:{},imageList:[],comment:[],OnComment:!1,uploadComment:\"\",liked:!1,stored:!1},a}return Object(n[\"a\"])(i,[{key:\"componentDidMount\",value:function(){var e,t,i,a,s=this,n=f.post.request((null===(e=this.$instance.router)||void 0===e?void 0:e.params.url)+\"/detail\",\"GET\",{id:JSON.parse(null!==(t=this.$instance.router)&&void 0!==t&&t.params.id?null===(i=this.$instance.router)||void 0===i?void 0:i.params.id:\"0\"),classify:null===(a=this.$instance.router)||void 0===a?void 0:a.params.class});n.then((function(e){var t;\"/activity\"===(null===(t=s.$instance.router)||void 0===t?void 0:t.params.url)?s.setState({detail:e.data.detail,imageList:e.data.imageList,liked:e.data.liked,stored:e.data.stored}):s.setState({detail:e.data.detail,imageList:e.data.imageList,comment:e.data.comment,liked:e.data.liked,stored:e.data.stored}),console.log(s.state.detail)}))}},{key:\"componentWillReceiveProps\",value:function(e){console.log(this.props,e)}},{key:\"shouldComponentUpdate\",value:function(e){return this.state!==e}},{key:\"componentWillUnmount\",value:function(){}},{key:\"componentDidlUpdate\",value:function(){}},{key:\"componentDidShow\",value:function(){}},{key:\"componentDidHide\",value:function(){}},{key:\"ToComment\",value:function(){this.setState({OnComment:!0})}},{key:\"WriteComment\",value:function(e){this.setState({uploadComment:e})}},{key:\"handOnComment\",value:function(){var e,t,i,a=this,s=f.post.request((null===(e=this.$instance.router)||void 0===e?void 0:e.params.url)+\"/addComment\",\"POST\",{nickname:j.a.getStorageSync(\"NICKNAME\"),comment:this.state.uploadComment,id:JSON.parse(null!==(t=this.$instance.router)&&void 0!==t&&t.params.id?null===(i=this.$instance.router)||void 0===i?void 0:i.params.id:\"0\")}).catch((function(e){console.log(e),j.a.showToast({title:\"\\u4e0a\\u4f20\\u8bc4\\u8bba\\u5931\\u8d25\",icon:\"error\",duration:2e3})}));s.then((function(){j.a.showToast({title:\"\\u4e0a\\u4f20\\u8bc4\\u8bba\\u6210\\u529f\",icon:\"success\",duration:2e3}),setTimeout((function(){a.setState({OnComment:!1})}),1e3)}))}},{key:\"itemLike\",value:function(){var e,t,i,a,s=this,n=f.post.request((null===(e=this.$instance.router)||void 0===e?void 0:e.params.url)+\"/like\",\"POST\",{item_id:JSON.parse(null!==(t=this.$instance.router)&&void 0!==t&&t.params.id?null===(i=this.$instance.router)||void 0===i?void 0:i.params.id:\"0\"),classify:null===(a=this.$instance.router)||void 0===a?void 0:a.params.class,option:!1===this.state.liked?\"add\":\"delete\"}).catch((function(e){console.log(e),j.a.showToast({title:\"\\u70b9\\u8d5e\\u5931\\u8d25\",icon:\"error\",duration:2e3})}));n.then((function(){s.setState({liked:!1===s.state.liked})}))}},{key:\"itemStore\",value:function(){var e,t,i,a,s=this,n=f.post.request((null===(e=this.$instance.router)||void 0===e?void 0:e.params.url)+\"/store\",\"POST\",{item_id:JSON.parse(null!==(t=this.$instance.router)&&void 0!==t&&t.params.id?null===(i=this.$instance.router)||void 0===i?void 0:i.params.id:\"0\"),classify:null===(a=this.$instance.router)||void 0===a?void 0:a.params.class,option:!1===this.state.stored?\"add\":\"delete\"}).catch((function(e){console.log(e),j.a.showToast({title:\"\\u6536\\u85cf\\u5931\\u8d25\",icon:\"error\",duration:2e3})}));n.then((function(){s.setState({stored:!1===s.state.stored})}))}},{key:\"commentLike\",value:function(e,t){var i,a=this,s=f.post.request((null===(i=this.$instance.router)||void 0===i?void 0:i.params.url)+\"/commentLike\",\"POST\",{comment_id:t,option:!1===this.state.comment[e].liked?\"add\":\"delete\"}).catch((function(e){console.log(e),j.a.showToast({title:\"\\u70b9\\u8d5e\\u5931\\u8d25\",icon:\"error\",duration:2e3})}));s.then((function(){var t=a.state.comment;t.map((function(t,i){t.likeCount=i===e?!1===t.liked?t.likeCount+1:t.likeCount-1:t.likeCount,t.liked=i===e?!t.liked:t.liked})),a.setState({comment:t})}))}},{key:\"preview\",value:function(e){var t=new Array,i=f.config.file+this.state.imageList[e].localPath;this.state.imageList.map((function(e){t.push(f.config.file+e.localPath)})),j.a.previewImage({current:i,urls:t})}},{key:\"render\",value:function(){var e,t,i=this;return\"activity\"===(null===(e=this.$instance.router)||void 0===e?void 0:e.params.class)?Object(p[\"jsxs\"])(m[\"r\"],{children:[Object(p[\"jsxs\"])(m[\"r\"],{className:\"at-article\",children:[Object(p[\"jsx\"])(m[\"r\"],{className:\"at-article__h1\",children:this.state.detail.topicValue}),Object(p[\"jsxs\"])(m[\"r\"],{className:\"at-article__info\",children:[this.state.detail.created_at,\"\\xa0\\xa0\\xa0\",this.state.detail.nickname]}),Object(p[\"jsx\"])(m[\"r\"],{className:\"at-article__content\",children:Object(p[\"jsxs\"])(m[\"r\"],{className:\"at-article__section\",children:[Object(p[\"jsx\"])(m[\"r\"],{className:\"at-article__h3\",children:\"\\u6d3b\\u52a8\\u65f6\\u95f4\\uff1a\"}),Object(p[\"jsx\"])(m[\"r\"],{className:\"at-article__p\",children:this.state.detail.year+\"-\"+this.state.detail.month+\"-\"+this.state.detail.date+\"  \"+this.state.detail.timeValue}),Object(p[\"jsx\"])(m[\"r\"],{className:\"at-article__h3\",children:\"\\u6d3b\\u52a8\\u5730\\u70b9\\uff1a\"}),Object(p[\"jsx\"])(m[\"r\"],{className:\"at-article__p\",children:this.state.detail.placeValue}),Object(p[\"jsx\"])(m[\"r\"],{className:\"at-article__h3\",children:\"\\u6d3b\\u52a8\\u5185\\u5bb9\\uff1a\"}),Object(p[\"jsx\"])(m[\"r\"],{className:\"at-article__p\",children:this.state.detail.contentValue}),Object(p[\"jsx\"])(m[\"r\"],{className:\"image-box\",children:this.state.imageList.map((function(e,t){return Object(p[\"jsx\"])(m[\"r\"],{className:\"image-item\",children:Object(p[\"jsx\"])(m[\"d\"],{className:\"image-item-i\",src:f.config.file+e.localPath,mode:\"aspectFill\",onClick:i.preview.bind(i,t)})},t)}))})]})})]}),Object(p[\"jsx\"])(m[\"d\"],{className:\"divider\",mode:\"widthFix\",src:f.config.file+\"/divider.png\"}),Object(p[\"jsxs\"])(m[\"r\"],{className:\"option\",children:[Object(p[\"jsxs\"])(m[\"r\"],{className:\"option-like\",children:[!0===this.state.liked?Object(p[\"jsx\"])(m[\"d\"],{className:\"image-like\",src:f.config.file+\"/item_liked.png\",onClick:function(){return i.itemLike()}}):Object(p[\"jsx\"])(m[\"d\"],{className:\"image-like\",src:f.config.file+\"/item_unlike.png\",onClick:function(){return i.itemLike()}}),Object(p[\"jsx\"])(m[\"p\"],{children:\"\\u559c\\u6b22\"})]}),Object(p[\"jsxs\"])(m[\"r\"],{className:\"option-store\",children:[!0===this.state.stored?Object(p[\"jsx\"])(m[\"d\"],{className:\"image-store\",src:f.config.file+\"/stored.png\",onClick:function(){return i.itemStore()}}):Object(p[\"jsx\"])(m[\"d\"],{className:\"image-store\",src:f.config.file+\"/unstore.png\",onClick:function(){return i.itemStore()}}),Object(p[\"jsx\"])(m[\"p\"],{children:\"\\u6dfb\\u52a0\\u81f3\\u65e5\\u7a0b\\u8868\"})]})]})]}):\"feedback\"===(null===(t=this.$instance.router)||void 0===t?void 0:t.params.class)?Object(p[\"jsx\"])(m[\"r\"],{children:Object(p[\"jsxs\"])(m[\"r\"],{className:\"at-article\",children:[Object(p[\"jsx\"])(m[\"r\"],{className:\"at-article__h1\",children:this.state.detail.topicValue}),Object(p[\"jsxs\"])(m[\"r\"],{className:\"at-article__info\",children:[this.state.detail.created_at,\"\\xa0\\xa0\\xa0\",this.state.detail.nickname]})]})}):Object(p[\"jsxs\"])(m[\"r\"],{children:[Object(p[\"jsxs\"])(m[\"r\"],{className:\"at-article\",children:[Object(p[\"jsx\"])(m[\"r\"],{className:\"at-article__h1\",children:this.state.detail.topicValue}),Object(p[\"jsxs\"])(m[\"r\"],{className:\"at-article__info\",children:[this.state.detail.created_at,\"\\xa0\\xa0\\xa0\",this.state.detail.nickname]}),Object(p[\"jsx\"])(m[\"r\"],{className:\"at-article__content\",children:Object(p[\"jsxs\"])(m[\"r\"],{className:\"at-article__section\",children:[Object(p[\"jsx\"])(m[\"r\"],{className:\"at-article__p\",children:this.state.detail.contentValue}),Object(p[\"jsx\"])(m[\"r\"],{className:\"image-box\",children:this.state.imageList.map((function(e,t){return Object(p[\"jsx\"])(m[\"r\"],{className:\"image-item\",children:Object(p[\"jsx\"])(m[\"d\"],{className:\"image-item-i\",src:f.config.file+e.localPath,mode:\"aspectFill\",onClick:i.preview.bind(i,t)})},t)}))})]})})]}),Object(p[\"jsx\"])(m[\"d\"],{className:\"divider\",mode:\"widthFix\",src:f.config.file+\"/divider.png\"}),Object(p[\"jsxs\"])(m[\"r\"],{className:\"option\",children:[Object(p[\"jsxs\"])(m[\"r\"],{className:\"option-like\",children:[!0===this.state.liked?Object(p[\"jsx\"])(m[\"d\"],{className:\"image-like\",src:f.config.file+\"/item_liked.png\",onClick:function(){return i.itemLike()}}):Object(p[\"jsx\"])(m[\"d\"],{className:\"image-like\",src:f.config.file+\"/item_unlike.png\",onClick:function(){return i.itemLike()}}),Object(p[\"jsx\"])(m[\"p\"],{children:\"\\u559c\\u6b22\"})]}),Object(p[\"jsxs\"])(m[\"r\"],{className:\"option-store\",children:[!0===this.state.stored?Object(p[\"jsx\"])(m[\"d\"],{className:\"image-store\",src:f.config.file+\"/stored.png\",onClick:function(){return i.itemStore()}}):Object(p[\"jsx\"])(m[\"d\"],{className:\"image-store\",src:f.config.file+\"/unstore.png\",onClick:function(){return i.itemStore()}}),Object(p[\"jsx\"])(m[\"p\"],{children:\"\\u6536\\u85cf\"})]})]}),Object(p[\"jsx\"])(m[\"p\"],{className:\"comment-title\",children:\"\\u7559\\u8a00\\u680f\"}),Object(p[\"jsx\"])(m[\"r\"],{className:\"comment\",children:this.state.comment.length>0?this.state.comment.map((function(e,t){return Object(p[\"jsxs\"])(m[\"r\"],{className:\"comment-list\",children:[Object(p[\"jsxs\"])(m[\"r\"],{className:\"comment-msg\",children:[Object(p[\"jsx\"])(m[\"d\"],{className:\"user-image\",src:f.config.file+e.avatar,mode:\"aspectFill\"}),Object(p[\"jsx\"])(m[\"p\"],{className:\"user-nickname\",children:e.nickname}),Object(p[\"jsx\"])(m[\"r\"],{className:0===e.likeCount?\"comment-nobody\":\"comment-likecount\",children:e.likeCount}),!0===e.liked?Object(p[\"jsx\"])(m[\"d\"],{className:\"liked\",src:f.config.file+\"/comment_liked.png\",onClick:i.commentLike.bind(i,t,e.id)}):Object(p[\"jsx\"])(m[\"d\"],{className:\"unliked\",src:f.config.file+\"/comment_unlike.png\",onClick:i.commentLike.bind(i,t,e.id)})]}),Object(p[\"jsx\"])(m[\"r\"],{className:\"comment-content\",children:e.content})]},t)})):Object(p[\"jsx\"])(m[\"r\"],{className:\"none\",children:\"\\u5feb\\u6765\\u62a2\\u6c99\\u53d1\\uff5e\"})}),Object(p[\"jsx\"])(u[\"f\"],{className:\"comment-fab\",size:\"normal\",onClick:function(){return i.ToComment()},children:Object(p[\"jsx\"])(m[\"p\"],{children:\"\\u6211\\u8981\\u7559\\u8a00\"})}),Object(p[\"jsxs\"])(u[\"g\"],{isOpened:this.state.OnComment,title:\"\\u7559\\u8a00\\u5185\\u5bb9\",children:[Object(p[\"jsx\"])(u[\"o\"],{value:this.state.uploadComment,onChange:function(e){return i.WriteComment(e)},count:!1,maxLength:200,placeholder:\"\\u8bc4\\u8bba\\u5185\\u5bb9...\",height:300}),Object(p[\"jsx\"])(m[\"r\"],{className:\"comment-submit\",onClick:function(){return i.handOnComment()},children:Object(p[\"jsx\"])(m[\"p\"],{children:\"\\u53d1\\u5e03\\u7559\\u8a00\"})})]})]})}}]),i}(d[\"Component\"]),b=O,k={navigationBarTitleText:\"\\u8be6\\u60c5\\u9875\"};Page(Object(a[\"createPageConfig\"])(b,\"pages/Detail/Detail\",{root:{cn:[]}},k||{}))}},[[128,0,1,2]]]);","extractedComments":[]}