{"code":"(wx[\"webpackJsonp\"]=wx[\"webpackJsonp\"]||[]).push([[44],{116:function(e,t,a){\"use strict\";a.r(t);var n=a(4),s=a(6),c=a(7),l=a(15),i=a(9),o=a(10),r=a(13),u=a(1),d=a(0),h=a(8),j=a(3),m=a.n(j),p=m.a.getApp(),O=[\"\\u5f81\\u53cb\",\"\\u5e2e\\u5fd9\",\"\\u95ee\\u9898\\u54a8\\u8be2\"],b=[\"make_friend\",\"help\",\"QA\"];function x(e,t,a){for(var n=new Array,s=function(s){n.push(new Promise((function(n,c){m.a.uploadFile({url:p.config.api+\"/upload/imageAdd\",filePath:t[s].url,name:\"file\",formData:{title:a,className:e,num:s+1},header:{authorrization:\"Bearer \".concat(m.a.getStorageSync(\"USER\")),\"content-type\":\"application/x-www-form-urlencoded\",uid:\"\".concat(m.a.getStorageSync(\"UID\"))},success:function(e){500===e.statusCode?c(new Error(JSON.parse(e.data))):n(e)},fail:c})})))},c=0;c<t.length;c++)s(c);return n}a(95);var f=a(2),v=m.a.getApp(),g=\"\",N={},k=function(e){Object(i[\"a\"])(a,e);var t=Object(o[\"a\"])(a);function a(e){var n;return Object(s[\"a\"])(this,a),n=t.call(this,e),Object(r[\"a\"])(Object(l[\"a\"])(n),\"$instance\",Object(j[\"getCurrentInstance\"])()),n.state={topicValue:\"\",timeValue:\"\",placeValue:\"\",contentValue:\"\",files:[],dateSelect:\"2000-01-01\",selectorChecked:-1},n}return Object(c[\"a\"])(a,[{key:\"componentDidMount\",value:function(){var e;\"item\"!==(null===(e=this.$instance.router)||void 0===e?void 0:e.params.sort)&&this.setState({selectorChecked:-2})}},{key:\"componentWillReceiveProps\",value:function(e){console.log(this.props,e)}},{key:\"componentWillUnmount\",value:function(){}},{key:\"componentDidShow\",value:function(){}},{key:\"componentDidHide\",value:function(){}},{key:\"uploadClass\",value:function(e){this.setState({selectorChecked:parseInt(e.detail.value)})}},{key:\"handOnTopic\",value:function(e){this.setState({topicValue:e.detail.value})}},{key:\"handOnTime\",value:function(e){this.setState({timeValue:e.detail.value})}},{key:\"handOnPlace\",value:function(e){this.setState({placeValue:e.detail.value})}},{key:\"handOnContent\",value:function(e){this.setState({contentValue:e.detail.value})}},{key:\"handOnImage\",value:function(e){this.setState({files:e})}},{key:\"handOnDate\",value:function(e){this.setState({dateSelect:e.detail.value})}},{key:\"Back\",value:function(){var e=m.a.getCurrentPages(),t=e[e.length-2];t.onLoad(),m.a.navigateBack({delta:1})}},{key:\"uploadDetail\",value:function(){var e,t,a=this,n=new Array,s=x(\"item\"===(null===(e=this.$instance.router)||void 0===e?void 0:e.params.sort)?b[this.state.selectorChecked]:(null===(t=this.$instance.router)||void 0===t?void 0:t.params.sort)+\"\",this.state.files,this.state.topicValue);Promise.all(s).then((function(e){var t,s;e.map((function(e){n.push(JSON.parse(e.data))}));var c=JSON.stringify(n);\"activity\"===(null===(t=a.$instance.router)||void 0===t?void 0:t.params.sort)?(g=\"/activity/add\",N={topicValue:a.state.topicValue,timeValue:a.state.timeValue,placeValue:a.state.placeValue,contentValue:a.state.contentValue,dateSelect:a.state.dateSelect,imageInfo:c}):\"feedback\"===(null===(s=a.$instance.router)||void 0===s?void 0:s.params.sort)?(g=\"/feedback/add\",N={topicValue:a.state.topicValue,contentValue:a.state.contentValue,imageInfo:c,sort:\"Q\"}):(g=\"/item/add\",N={topicValue:a.state.topicValue,contentValue:a.state.contentValue,imageInfo:c,classify:b[a.state.selectorChecked]});var l=v.post.request(g,\"POST\",N);l.then((function(e){m.a.showToast({title:e.data,icon:\"success\",duration:2e3}).then((function(){setTimeout((function(){a.Back()}),2e3)}))}))})).catch((function(e){m.a.showToast({title:e.message,icon:\"error\",duration:2e3})}))}},{key:\"render\",value:function(){var e,t,a=this;return-1===this.state.selectorChecked?Object(f[\"jsx\"])(d[\"r\"],{className:\"container\",children:Object(f[\"jsx\"])(d[\"j\"],{mode:\"selector\",range:O,onChange:function(e){return a.uploadClass(e)},children:Object(f[\"jsx\"])(h[\"k\"],{children:Object(f[\"jsx\"])(h[\"l\"],{title:\"\\u8bf7\\u9009\\u62e9\\u9700\\u8981\\u4e0a\\u4f20\\u7684\\u7c7b\\u578b\",extraText:O[this.state.selectorChecked]})})})}):\"activity\"===(null===(e=this.$instance.router)||void 0===e?void 0:e.params.sort)?Object(f[\"jsxs\"])(d[\"r\"],{className:\"container\",children:[Object(f[\"jsxs\"])(d[\"r\"],{className:\"title\",children:[Object(f[\"jsx\"])(d[\"r\"],{className:\"title-dot\"}),Object(f[\"jsx\"])(d[\"p\"],{className:\"act-title\",children:\"\\u6d3b\\u52a8\\u4e3b\\u9898\"})]}),Object(f[\"jsx\"])(d[\"q\"],{className:\"content\",value:this.state.topicValue,onInput:function(e){return a.handOnTopic(e)},disableDefaultPadding:!0,autoHeight:!0,maxlength:30,placeholder:\"\\u60a8\\u7684\\u6d3b\\u52a8\\u4e3b\\u9898\\u662f...(\\u5efa\\u8bae15\\u5b57\\u4ee5\\u5185)\"}),Object(f[\"jsxs\"])(d[\"r\"],{className:\"title\",children:[Object(f[\"jsx\"])(d[\"r\"],{className:\"title-dot\"}),Object(f[\"jsx\"])(d[\"p\"],{className:\"act-title\",children:\"\\u6d3b\\u52a8\\u65e5\\u671f\"})]}),Object(f[\"jsx\"])(d[\"r\"],{className:\"date-select\",children:Object(f[\"jsx\"])(d[\"j\"],{mode:\"date\",value:\"\",onChange:function(e){return a.handOnDate(e)},children:Object(f[\"jsx\"])(h[\"k\"],{children:Object(f[\"jsx\"])(h[\"l\"],{title:\"\\u8bf7\\u9009\\u62e9\\u65e5\\u671f\",extraText:this.state.dateSelect})})})}),Object(f[\"jsxs\"])(d[\"r\"],{className:\"title\",children:[Object(f[\"jsx\"])(d[\"r\"],{className:\"title-dot\"}),Object(f[\"jsx\"])(d[\"p\"],{className:\"act-title\",children:\"\\u6d3b\\u52a8\\u65f6\\u95f4\\u6bb5\"})]}),Object(f[\"jsx\"])(d[\"q\"],{className:\"content\",value:this.state.timeValue,onInput:function(e){return a.handOnTime(e)},disableDefaultPadding:!0,autoHeight:!0,maxlength:15,placeholder:\"\\u4f8b: 9:00~18:00\"}),Object(f[\"jsxs\"])(d[\"r\"],{className:\"title\",children:[Object(f[\"jsx\"])(d[\"r\"],{className:\"title-dot\"}),Object(f[\"jsx\"])(d[\"p\"],{className:\"act-title\",children:\"\\u6d3b\\u52a8\\u5730\\u70b9\"})]}),Object(f[\"jsx\"])(d[\"q\"],{className:\"content\",value:this.state.placeValue,onInput:function(e){return a.handOnPlace(e)},disableDefaultPadding:!0,autoHeight:!0,maxlength:50,placeholder:\"\\u60a8\\u7684\\u6d3b\\u52a8\\u5730\\u70b9\\u662f...\"}),Object(f[\"jsxs\"])(d[\"r\"],{className:\"title\",children:[Object(f[\"jsx\"])(d[\"r\"],{className:\"title-dot\"}),Object(f[\"jsx\"])(d[\"p\"],{className:\"act-title\",children:\"\\u6d3b\\u52a8\\u5185\\u5bb9\\u7b80\\u4ecb\"})]}),Object(f[\"jsx\"])(d[\"q\"],{className:\"content\",value:this.state.contentValue,onInput:function(e){return a.handOnContent(e)},disableDefaultPadding:!0,autoHeight:!0,maxlength:600,placeholder:\"\\u60a8\\u7684\\u6d3b\\u52a8\\u5185\\u5bb9\\u662f...(500\\u5b57\\u4ee5\\u5185)\"}),Object(f[\"jsxs\"])(d[\"r\"],{className:\"title\",children:[Object(f[\"jsx\"])(d[\"r\"],{className:\"title-dot\"}),Object(f[\"jsx\"])(d[\"p\"],{className:\"act-title\",children:\"\\u56fe\\u7247\\u4fe1\\u606f\\uff08\\u7b2c\\u4e00\\u5f20\\u4f5c\\u4e3a\\u5c55\\u677f\\uff09\"})]}),Object(f[\"jsx\"])(h[\"j\"],{files:this.state.files,onChange:function(e){return a.handOnImage(e)},onFail:function(){}}),Object(f[\"jsx\"])(d[\"r\"],{className:\"submit\",onClick:function(){return a.uploadDetail()},children:Object(f[\"jsx\"])(d[\"p\"],{children:\"\\u63d0\\u4ea4\"})}),Object(f[\"jsx\"])(d[\"r\"],{className:\"gap\"})]}):\"feedback\"===(null===(t=this.$instance.router)||void 0===t?void 0:t.params.sort)?Object(f[\"jsxs\"])(d[\"r\"],{className:\"container\",children:[Object(f[\"jsxs\"])(d[\"r\"],{className:\"title\",children:[Object(f[\"jsx\"])(d[\"r\"],{className:\"title-dot\"}),Object(f[\"jsx\"])(d[\"p\"],{className:\"act-title\",children:\"\\u53cd\\u9988\\u4e3b\\u9898\"})]}),Object(f[\"jsx\"])(d[\"q\"],{className:\"content\",value:this.state.topicValue,onInput:function(e){return a.handOnTopic(e)},disableDefaultPadding:!0,autoHeight:!0,maxlength:30,placeholder:\"\\u53cd\\u9988\\u95ee\\u9898\\u7b80\\u8ff0...(\\u5efa\\u8bae15\\u5b57\\u4ee5\\u5185)\"}),Object(f[\"jsxs\"])(d[\"r\"],{className:\"title\",children:[Object(f[\"jsx\"])(d[\"r\"],{className:\"title-dot\"}),Object(f[\"jsx\"])(d[\"p\"],{className:\"act-title\",children:\"\\u53cd\\u9988\\u95ee\\u9898\\u8bf4\\u660e\"})]}),Object(f[\"jsx\"])(d[\"q\"],{className:\"content\",value:this.state.contentValue,onInput:function(e){return a.handOnContent(e)},disableDefaultPadding:!0,autoHeight:!0,maxlength:600,placeholder:\"\\u60a8\\u7684\\u5177\\u4f53\\u53cd\\u9988\\u95ee\\u9898\\u662f...(500\\u5b57\\u4ee5\\u5185)\"}),Object(f[\"jsxs\"])(d[\"r\"],{className:\"title\",children:[Object(f[\"jsx\"])(d[\"r\"],{className:\"title-dot\"}),Object(f[\"jsx\"])(d[\"p\"],{className:\"act-title\",children:\"\\u56fe\\u7247\\u4fe1\\u606f\\uff08\\u7b2c\\u4e00\\u5f20\\u4f5c\\u4e3a\\u5c55\\u677f\\uff09\"})]}),Object(f[\"jsx\"])(h[\"j\"],{files:this.state.files,onChange:function(e){return a.handOnImage(e)}}),Object(f[\"jsx\"])(d[\"r\"],{className:\"submit\",onClick:function(){return a.uploadDetail()},children:Object(f[\"jsx\"])(d[\"p\"],{children:\"\\u63d0\\u4ea4\"})})]}):Object(f[\"jsxs\"])(d[\"r\"],{className:\"container\",children:[Object(f[\"jsxs\"])(d[\"r\"],{className:\"title\",children:[Object(f[\"jsx\"])(d[\"r\"],{className:\"title-dot\"}),Object(f[\"jsx\"])(d[\"p\"],{className:\"act-title\",children:\"\\u5185\\u5bb9\\u4e3b\\u9898\"})]}),Object(f[\"jsx\"])(d[\"q\"],{className:\"content\",value:this.state.topicValue,onInput:function(e){return a.handOnTopic(e)},disableDefaultPadding:!0,autoHeight:!0,maxlength:30,placeholder:\"\\u60a8\\u7684\\u6d3b\\u52a8\\u4e3b\\u9898\\u662f...(\\u5efa\\u8bae15\\u5b57\\u4ee5\\u5185)\"}),Object(f[\"jsxs\"])(d[\"r\"],{className:\"title\",children:[Object(f[\"jsx\"])(d[\"r\"],{className:\"title-dot\"}),Object(f[\"jsx\"])(d[\"p\"],{className:\"act-title\",children:\"\\u5185\\u5bb9\\u8bf4\\u660e\"})]}),Object(f[\"jsx\"])(d[\"q\"],{className:\"content\",value:this.state.contentValue,onInput:function(e){return a.handOnContent(e)},disableDefaultPadding:!0,autoHeight:!0,maxlength:600,placeholder:\"\\u60a8\\u7684\\u5177\\u4f53\\u5185\\u5bb9\\u662f...(500\\u5b57\\u4ee5\\u5185)\"}),Object(f[\"jsxs\"])(d[\"r\"],{className:\"title\",children:[Object(f[\"jsx\"])(d[\"r\"],{className:\"title-dot\"}),Object(f[\"jsx\"])(d[\"p\"],{className:\"act-title\",children:\"\\u56fe\\u7247\\u4fe1\\u606f\\uff08\\u7b2c\\u4e00\\u5f20\\u4f5c\\u4e3a\\u5c55\\u677f\\uff09\"})]}),Object(f[\"jsx\"])(h[\"j\"],{files:this.state.files,onChange:function(e){return a.handOnImage(e)}}),Object(f[\"jsx\"])(d[\"r\"],{className:\"submit\",onClick:function(){return a.uploadDetail()},children:Object(f[\"jsx\"])(d[\"p\"],{children:\"\\u63d0\\u4ea4\"})})]})}}]),a}(u[\"Component\"]),V=k,C={navigationBarTitleText:\"\\u4e0a\\u4f20\\u5185\\u5bb9\"};Page(Object(n[\"createPageConfig\"])(V,\"pages/upload/upload\",{root:{cn:[]}},C||{}))},95:function(e,t,a){}},[[116,0,1,2]]]);","extractedComments":[]}