{"code":"(wx[\"webpackJsonp\"]=wx[\"webpackJsonp\"]||[]).push([[3],{20:function(t,e,a){\"use strict\";var n=a(6),s=a(7),r=a(9),i=a(10),c=a(1),o=a(3),l=a.n(o),h=a(0),d=(a(89),a(2)),u=l.a.getApp(),m=function(t){Object(r[\"a\"])(a,t);var e=Object(i[\"a\"])(a);function a(t){var s;return Object(n[\"a\"])(this,a),s=e.call(this,t),s.state={list:[]},s}return Object(s[\"a\"])(a,[{key:\"componentDidMount\",value:function(){this.loadList(this.props.url)}},{key:\"shouldComponentUpdate\",value:function(t,e){return this.props.url!==t.url&&this.loadList(t.url),this.state!==e}},{key:\"componentWillUnmount\",value:function(){}},{key:\"componentDidShow\",value:function(){}},{key:\"componentDidHide\",value:function(){}},{key:\"loadList\",value:function(t){var e=this,a=u.post.request(t,\"GET\");a.then((function(t){if(500===t.statusCode)throw new Error(t.data);if(0!==t.data.length){for(var a=300,n=new Array(t.data.length),s=0;s<t.data.length;s++)null!==t.data[s].image?n[s]=t.data[s].image[0].height*a/t.data[s].image[0].width:n[s]=300;for(var r=[0,0],i=[new Array,new Array],c=0;c<t.data.length;c++){var o=t.data[c].topicValue.length>10?2:1;2===o&&t.data[c].topicValue.length>15&&(t.data[c].topicValue=t.data[c].topicValue.substring(0,15)+\"...\");var l=r[1]<r[0]?1:0;i[l].push(t.data[c]),r[l]+=n[c]+29*o}e.setState({list:i})}else e.setState({list:[]})})).catch((function(t){l.a.showToast({title:t.message,icon:\"error\",duration:2e3})}))}},{key:\"imageError\",value:function(t,e){var a=this.state.list;a[t][e].image[0].url=\"/imageError.jpg\",this.setState({list:a})}},{key:\"toDetail\",value:function(t){l.a.navigateTo({url:\"/pages/Detail/Detail?class=\"+this.props.class+\"url=\"+this.props.url.split(\"?\")[0]+\"&id=\"+JSON.stringify(t)})}},{key:\"render\",value:function(){var t=this;return 0===this.state.list.length?Object(d[\"jsx\"])(h[\"r\"],{className:\"activity_list\",children:Object(d[\"jsx\"])(h[\"p\"],{children:\"\\u6682\\u65f6\\u8fd8\\u6ca1\\u6709\\u5185\\u5bb9\\u54e6\\uff5e\"})}):Object(d[\"jsx\"])(h[\"r\"],{className:\"main\",children:this.state.list.map((function(e,a){return Object(d[\"jsx\"])(h[\"r\"],{className:\"column\",children:e.map((function(e,n){return Object(d[\"jsxs\"])(h[\"r\"],{className:\"column_item\",onClick:t.toDetail.bind(t,e.id),children:[Object(d[\"jsxs\"])(h[\"r\"],{className:\"user_msg\",children:[Object(d[\"jsx\"])(h[\"d\"],{src:u.config.file+e.avatar,mode:\"aspectFill\"}),Object(d[\"jsx\"])(h[\"p\"],{children:e.nickname}),Object(d[\"jsx\"])(h[\"p\"],{className:\"time\",children:e.created_at.split(\" \")[0]})]}),Object(d[\"jsx\"])(h[\"d\"],{src:u.config.file+e.image[0].path,className:\"column_pic\",mode:\"widthFix\",onError:t.imageError.bind(t,a,n)}),Object(d[\"jsx\"])(h[\"r\"],{className:\"topic\",children:e.topicValue})]},n)}))},a)}))})}}]),a}(c[\"Component\"]);e[\"a\"]=m},28:function(t,e,a){\"use strict\";var n=a(6),s=a(7),r=a(9),i=a(10),c=a(1),o=a(0),l=a(8),h=(a(88),a(2)),d=new Date,u=function(t){Object(r[\"a\"])(a,t);var e=Object(i[\"a\"])(a);function a(t){var s;return Object(n[\"a\"])(this,a),s=e.call(this,t),s.state={calShow:!0,dateShow:!0,year:2001,month:d.getMonth(),selectweeks:[],date:d.getDate()},s}return Object(s[\"a\"])(a,[{key:\"componentDidMount\",value:function(){this.setState({calShow:!0}),this.getWeek(new Date)}},{key:\"componentWillReceiveProps\",value:function(t){console.log(this.props,t)}},{key:\"componentWillUnmount\",value:function(){}},{key:\"componentDidlUpdate\",value:function(){this.getWeek(new Date)}},{key:\"getWeek\",value:function(t){for(var e=this,a=new Date(t),n=a.getFullYear(),s=a.getMonth()+1,r=a.getDate(),i=[],c={firstDay:new Date(n,s-1,1).getDay(),lastMonthDays:[],currentMonthDys:[],nextMonthDays:[],endDay:new Date(n,s,0).getDay(),weeks:[]},o=c.firstDay;o>0;o--)c.lastMonthDays.push({date:new Date(n,s-1,1-o).getDate()+\"\",month:s-1});for(var l=1;l<=new Date(n,s,0).getDate();l++){var h=!1;c.currentMonthDys.push({date:l+\"\",month:s,have:h})}for(var d=1;d<7-c.endDay;d++)c.nextMonthDays.push({date:d+\"\",month:s+1});i=i.concat(c.lastMonthDays,c.currentMonthDys,c.nextMonthDays);for(var u=0;u<i.length;u++)u%7===0&&(c.weeks[u/7]=new Array(7)),c.weeks[Math.floor(u/7)][u%7]=i[u];this.setState({selectweeks:c.weeks,month:s,year:n,date:r},(function(){var t=e.judgeDate();e.props.dateUpdate(e.state.year,e.state.month,e.state.date,t)}))}},{key:\"dataBefor\",value:function(t){var e=0,a=t.currentTarget.dataset.type;e=\"0\"===t.currentTarget.dataset.id?-1:1;var n=this.state.year+\"-\"+this.state.month+\"-\"+this.state.date,s=this.getDate(n,e,\"month\"===a?\"month\":\"year\");this.getWeek(s)}},{key:\"getDate\",value:function(t,e){var a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:\"day\",n=new Date(t);switch(a){case\"month\":var s=new Date(n.getFullYear(),n.getMonth()+e+1,-0).getDate(),r=n.getDate()>s?s:n.getDate();n.setMonth(n.getMonth()+e,r);break;case\"year\":n.setFullYear(n.getFullYear()+e);break}var i=n.getFullYear(),c=n.getMonth()+1<10?\"0\"+(n.getMonth()+1):n.getMonth()+1,o=n.getDate()<10?\"0\"+n.getDate():n.getDate();return i+\"-\"+c+\"-\"+o}},{key:\"selectDay\",value:function(t){var e=t.currentTarget.dataset.index,a=t.currentTarget.dataset.week,n=this.state.year,s=t.currentTarget.dataset.ischeck,r=this.state.selectweeks;if(!s)return!1;var i=r[a][e].month<10?\"0\"+r[a][e].month:r[a][e].month,c=r[a][e].date<10?\"0\"+r[a][e].date:r[a][e].date;this.getWeek(n+\"-\"+i+\"-\"+c)}},{key:\"packup\",value:function(){var t=this;if(this.props.isOpen){var e=t.state.year+\"-\"+t.state.month+\"-\"+t.state.date,a=t.getDate(e,0);t.getWeek(a)}else t.setState({dateShow:!1},(function(){setTimeout((function(){t.setState({calShow:!1},(function(){var e=t.state.year+\"-\"+t.state.month+\"-\"+t.state.date,a=t.getDate(e,0);t.getWeek(a)}))}),300)}))}},{key:\"judgeDate\",value:function(){var t=new Date(new Date),e=t.getFullYear(),a=t.getMonth()+1,n=t.getDate(),s=0;return s=this.state.year<e||this.state.month<a||this.state.year===e&&this.state.month===a&&this.state.date<n?-1:this.state.year===e&&this.state.month===a&&this.state.date-n<14||this.state.year===e&&this.state.month===a+1&&this.state.date+(new Date(this.state.year,this.state.month,-0).getDate()-n)<13||this.state.year===e+1&&1===this.state.month&&12===a&&this.state.date+(31-n)<13?this.state.month===a?this.state.date-n:this.state.date+new Date(e,a,-0).getDate()-n+1:15,s}},{key:\"backtoday\",value:function(){this.getWeek(new Date)}},{key:\"componentDidShow\",value:function(){}},{key:\"componentDidHide\",value:function(){}},{key:\"render\",value:function(){var t=this,e=this.state,a=e.calShow,n=e.dateShow,s=e.year,r=e.date,i=e.selectweeks,c=e.month;if(a)return Object(h[\"jsx\"])(o[\"r\"],{className:[this.props.isOpen?\"\":\"calendar-box\",n?\"active\":\"\"].join(\"\"),children:Object(h[\"jsxs\"])(o[\"r\"],{className:[\"calendar-wrapper\",n?\"active\":\"\"].join(\"\"),children:[Object(h[\"jsxs\"])(o[\"r\"],{className:\"calendar-panel\",children:[Object(h[\"jsx\"])(o[\"r\"],{className:\"iconfont\",\"data-id\":\"0\",\"data-type\":\"month\",onClick:function(e){return t.dataBefor(e)},children:Object(h[\"jsx\"])(l[\"i\"],{value:\"chevron-left\",size:\"20\",color:\"#35a4de\"})}),Object(h[\"jsxs\"])(o[\"r\"],{className:\"calendar-panel-box\",children:[Object(h[\"jsxs\"])(o[\"r\"],{children:[s,\"\\u5e74\"]}),Object(h[\"jsxs\"])(o[\"r\"],{children:[c<10?\"0\"+c:c,\"\\u6708\"]})]}),Object(h[\"jsx\"])(o[\"r\"],{className:\"iconfont flex-center\",\"data-id\":\"1\",\"data-type\":\"month\",onClick:function(e){return t.dataBefor(e)},children:Object(h[\"jsx\"])(l[\"i\"],{value:\"chevron-right\",size:\"20\",color:\"#35a4de\"})})]}),Object(h[\"jsxs\"])(o[\"r\"],{className:\"calendar-header\",children:[Object(h[\"jsx\"])(o[\"p\"],{children:\"\\u65e5\"}),Object(h[\"jsx\"])(o[\"p\"],{children:\"\\u4e00\"}),Object(h[\"jsx\"])(o[\"p\"],{children:\"\\u4e8c\"}),Object(h[\"jsx\"])(o[\"p\"],{children:\"\\u4e09\"}),Object(h[\"jsx\"])(o[\"p\"],{children:\"\\u56db\"}),Object(h[\"jsx\"])(o[\"p\"],{children:\"\\u4e94\"}),Object(h[\"jsx\"])(o[\"p\"],{children:\"\\u516d\"})]}),Object(h[\"jsx\"])(o[\"r\"],{className:\"calendar-body\",children:Object(h[\"jsx\"])(o[\"a\"],{children:i.map((function(e,a){return Object(h[\"jsx\"])(o[\"r\"],{className:\"calender-body-date-week\",children:Object(h[\"jsx\"])(o[\"a\"],{children:e.map((function(e,n){return Object(h[\"jsx\"])(o[\"r\"],{className:[\"date\",e.date===r.toString()&&e.month===c?\"date-current\":\"\",e.month===c?\"\":\"placeholder\"].join(\",\"),\"data-week\":a,\"data-index\":n,\"data-ischeck\":e.month===c,onClick:function(e){return t.selectDay(e)},children:Object(h[\"jsx\"])(o[\"p\"],{className:\"datebox\",children:e.date})},n)}))})},a)}))})}),Object(h[\"jsx\"])(o[\"r\"],{className:\"packup\",onClick:function(){return t.backtoday()},children:\"\\u56de\\u5230\\u4eca\\u5929\"})]})})}}]),a}(c[\"PureComponent\"]);e[\"a\"]=u},88:function(t,e,a){},89:function(t,e,a){}}]);","extractedComments":[]}